IDENTIFICATION DIVISION.
PROGRAM-ID. PAYROLL-SYSTEM.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT EMPLOYEE-FILE ASSIGN TO "employees.dat"
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD EMPLOYEE-FILE.
01 EMPLOYEE-RECORD.
   05 EMP-ID        PIC 9(4).
   05 EMP-NAME      PIC X(20).
   05 GROSS-SALARY  PIC 9(6)V99.
   05 TAX-DEDUCTED  PIC 9(5)V99.
   05 NET-SALARY    PIC 9(6)V99.

WORKING-STORAGE SECTION.
01 WS-EOF          PIC X(1) VALUE SPACE.
01 TAX-RATE        PIC 9(2)V9(2) VALUE 0.10.

PROCEDURE DIVISION.
MAIN-PROCESS.
    OPEN INPUT EMPLOYEE-FILE.
    
    PERFORM UNTIL WS-EOF = "Y"
        READ EMPLOYEE-FILE INTO EMPLOYEE-RECORD
            AT END MOVE "Y" TO WS-EOF
            NOT AT END PERFORM CALCULATE-SALARY
    END-PERFORM.
    
    CLOSE EMPLOYEE-FILE.
    STOP RUN.

CALCULATE-SALARY.
    COMPUTE TAX-DEDUCTED = GROSS-SALARY * TAX-RATE.
    COMPUTE NET-SALARY = GROSS-SALARY - TAX-DEDUCTED.
    DISPLAY "Employee: " EMP-NAME " | Net Salary: $" NET-SALARY.
